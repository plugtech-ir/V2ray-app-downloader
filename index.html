<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دانلود مستقیم کلاینت‌های V2Ray</title>
    <!-- فونت Vazirmatn -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap">
    <!-- فونت آیکون Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4f46e5;
            --primary-hover: #4338ca;
            --secondary-color: #f3f4f6;
            --text-color: #1f2937;
            --light-text: #6b7280;
            --success-color: #10b981;
            --border-color: #e5e7eb;
            --border-radius: 12px;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Vazirmatn', system-ui, -apple-system, sans-serif;
            background-color: #f8fafc;
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 1rem;
        }

        .container { width: 100%; max-width: 700px; margin: 2rem 0; }
        .card { background-color: white; border-radius: var(--border-radius); box-shadow: var(--shadow); overflow: hidden; }
        .card-header { padding: 1.5rem; text-align: center; border-bottom: 1px solid var(--border-color); }
        .card-header h1 { font-size: 1.5rem; font-weight: 700; color: var(--primary-color); display: flex; align-items: center; justify-content: center; gap: 0.75rem; }
        .card-body { padding: 2rem; }
        .card-footer { padding: 1rem 1.5rem; background-color: var(--secondary-color); text-align: center; font-size: 0.875rem; color: var(--light-text); border-top: 1px solid var(--border-color); }

        a { color: var(--primary-color); text-decoration: none; font-weight: 500; }
        a:hover { color: var(--primary-hover); }
        
        #os-selection .selection-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1.5rem; text-align: center; }
        .os-card { background-color: white; padding: 2rem 1rem; border-radius: var(--border-radius); border: 1px solid var(--border-color); cursor: pointer; transition: all 0.2s ease; }
        .os-card:hover { transform: translateY(-5px); box-shadow: var(--shadow); border-color: var(--primary-color); }
        .os-card i { font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem; }
        .os-card h3 { font-weight: 600; }
        
        .page-intro { text-align: center; color: var(--light-text); margin-bottom: 2rem; }
        .app-list { display: none; }
        .list-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .back-btn { background: none; border: 1px solid #d1d5db; color: var(--light-text); padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 0.5rem; font-family: inherit; }
        .back-btn:hover { background-color: var(--secondary-color); color: var(--text-color); }

        .app-card { border: 1px solid var(--border-color); border-radius: var(--border-radius); margin-bottom: 1.5rem; overflow: hidden; }
        .app-header { padding: 1rem 1.5rem; background-color: #f9fafb; }
        .app-header h3 { font-size: 1.1rem; display: flex; align-items: center; gap: 0.75rem; }
        .app-body { padding: 1.5rem; }
        .app-body p { font-size: 0.9rem; color: var(--light-text); margin-bottom: 1.5rem; }
        
        .version-selector { display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap; }
        .version-selector label { font-weight: 500; font-size: 0.9rem; }
        .version-selector select { padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid var(--border-color); font-family: inherit; background-color: white; flex-grow: 1; }

        .download-group { margin-bottom: 1.5rem; }
        .download-group:last-child { margin-bottom: 0; }
        .download-group h4 {
            font-size: 1rem; display: flex; align-items: center; gap: 0.75rem;
            margin-bottom: 0.75rem; padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .download-links a {
            display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem;
            background-color: var(--secondary-color); border-radius: 8px; margin-bottom: 0.75rem;
            transition: all 0.2s ease; color: var(--text-color); font-weight: 500;
        }
        .download-links a:hover { background-color: #e5e7eb; color: var(--primary-color); }
        .download-links a i { width: 20px; text-align: center; color: var(--light-text); }
        .download-links .link-text { flex-grow: 1; }
        .download-links .arch-badge {
            background-color: #e5e7eb; color: var(--light-text); font-size: 0.75rem;
            padding: 0.1rem 0.6rem; border-radius: 9999px; font-weight: 600;
            border: 1px solid #d1d5db;
        }
        
        .cpu-helper { margin-top: 1.5rem; padding: 1.25rem; background-color: #f9fafb; border-radius: var(--border-radius); border: 1px solid var(--border-color); font-size: 0.85rem; }
        .cpu-helper h4 { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem; font-weight: 600; }
        .cpu-helper p { color: var(--light-text); margin-bottom: 0.5rem !important; }
        .cpu-helper code { background: #e5e7eb; color: #4b5563; padding: 2px 6px; border-radius: 4px; font-size: 0.9em; }

        .loading-spinner { width: 30px; height: 30px; border: 3px solid rgba(79, 70, 229, 0.2); border-radius: 50%; border-top-color: var(--primary-color); animation: spin 1s ease-in-out infinite; margin: 2rem auto; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .error-message { text-align: center; color: #ef4444; padding: 1rem; background-color: rgba(239, 68, 68, 0.1); border-radius: 8px; }
    </style>
</head>

<body>
    <div class="container">
        <div class="card">
            <div class="card-header"><h1><i id="header-icon" class="fas fa-shield-alt"></i><span id="header-title">دانلود کلاینت‌های V2Ray</span></h1></div>
            <div class="card-body">
                <div id="os-selection">
                    <p class="page-intro">سیستم عامل دستگاه خود را انتخاب کنید تا بهترین کلاینت‌ها برای شما نمایش داده شود.</p>
                    <div class="selection-grid">
                        <div class="os-card" onclick="showApps('android')"><i class="fab fa-android"></i><h3>اندروید</h3></div>
                        <div class="os-card" onclick="showApps('ios')"><i class="fab fa-apple"></i><h3>آی‌او‌اس</h3></div>
                        <div class="os-card" onclick="showApps('windows')"><i class="fab fa-windows"></i><h3>ویندوز</h3></div>
                        <div class="os-card" onclick="showApps('macos')"><i class="fab fa-apple"></i><h3>مک</h3></div>
                        <div class="os-card" onclick="showApps('linux')"><i class="fab fa-linux"></i><h3>لینوکس</h3></div>
                    </div>
                </div>

                <!-- Android Apps -->
                <div id="android-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-android"></i> برنامه‌های اندروید</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                    <div class="app-card">
                        <div class="app-header"><h3><i class="fas fa-rocket"></i> v2rayNG</h3></div>
                        <div class="app-body">
                            <p>محبوب‌ترین کلاینت برای اندروید. این صفحه فقط نسخه Universal را برای سازگاری با تمام دستگاه‌ها نمایش می‌دهد.</p>
                            <div class="app-content" data-repo="2dust/v2rayNG" data-os="android"></div>
                        </div>
                    </div>
                </div>
                
                <!-- iOS Apps -->
                <div id="ios-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-apple"></i> برنامه‌های آی‌او‌اس</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                    <div class="app-card"><div class="app-header"><h3><i class="fas fa-paper-plane"></i> Shadowrocket</h3></div><div class="app-body"><p>قدرتمندترین اپلیکیشن پولی برای iOS. برای دانلود به اپ استور هدایت می‌شوید.</p><div class="download-links"><a href="https://apps.apple.com/us/app/shadowrocket/id932747118" target="_blank" rel="noopener noreferrer"><i class="fab fa-app-store-ios"></i> مشاهده در اپ استور</a></div></div></div>
                </div>
                
                <!-- Windows Apps -->
                <div id="windows-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-windows"></i> برنامه‌های ویندوز</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                    <div class="app-card">
                        <div class="app-header"><h3><i class="fas fa-leaf"></i> v2rayN</h3></div>
                        <div class="app-body">
                            <p>کلاینت استاندارد و محبوب ویندوز. نسخه مناسب با پردازنده سیستم خود را انتخاب کنید.</p>
                            <div class="app-content" data-repo="2dust/v2rayN" data-os="windows"></div>
                        </div>
                        <div class="cpu-helper"><h4<i class="fas fa-microchip"></i> چگونه نوع پردازنده را در ویندوز پیدا کنیم؟</h4><p>۱. به **Settings** (تنظیمات) بروید.</p><p>۲. وارد بخش **System** و سپس **About** شوید.</p><p>۳. در قسمت `System type`، نوع پردازنده شما نوشته شده است (مثلاً `x64-based processor`).</p></div>
                    </div>
                </div>
                
                <!-- macOS Apps -->
                <div id="macos-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-apple"></i> برنامه‌های مک</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                     <div class="app-card">
                        <div class="app-header"><h3><i class="fas fa-draw-polygon"></i> Clash Verge</h3></div>
                        <div class="app-body"><p>کلاینت مدرن مبتنی بر Clash. نسخه مناسب پردازende مک خود (Intel یا Apple Silicon) را انتخاب کنید.</p><div class="app-content" data-repo="zzzgydi/clash-verge" data-os="macos"></div></div>
                        <div class="cpu-helper"><h4><i class="fas fa-microchip"></i> چگونه نوع پردازنده را در مک پیدا کنیم؟</h4><p>۱. روی **منوی اپل** () در گوشه بالا سمت چپ کلیک کنید.</p><p>۲. گزینه **About This Mac** را انتخاب کنید.</p><p>۳. اگر در بخش `Chip` عبارت **Apple M1/M2/M3** را دیدید، پردازنده شما **ARM64** است. در غیر این صورت، **Intel (x64)** است.</p></div>
                    </div>
                </div>
                
                <!-- Linux Apps -->
                <div id="linux-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-linux"></i> برنامه‌های لینوکس</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                    <div class="app-card">
                        <div class="app-header"><h3><i class="fas fa-network-wired"></i> v2rayA</h3></div>
                        <div class="app-body"><p>کلاینت قدرتمند با رابط کاربری تحت وب. فایل مناسب توزیع و پردازنده خود را دانلود کنید.</p><div class="app-content" data-repo="v2rayA/v2rayA" data-os="linux"></div></div>
                        <div class="cpu-helper"><h4><i class="fas fa-microchip"></i> چگونه نوع پردازنده را در لینوکس پیدا کنیم؟</h4><p>۱. **راه ساده (گرافیکی):** به `Settings > About` بروید. نوع سیستم عامل (OS Type) معمولاً `64-bit` را نشان می‌دهد.</p><p>۲. **راه دقیق (ترمینال):** یک ترمینال باز کنید و دستور <code>uname -m</code> را وارد کنید. خروجی `x86_64` به معنی **x64** و `aarch64` به معنی **ARM64** است.</p></div>
                    </div>
                </div>
            </div>
            <div class="card-footer"><div>نوشته شده توسط <a href="https://t.me/wolf_vpn02" target="_blank" rel="noopener noreferrer">WOLF VPN</a></div></div>
        </div>
    </div>

    <script>
        const osSelection = document.getElementById('os-selection');
        const appLists = document.querySelectorAll('.app-list');
        const headerTitle = document.getElementById('header-title');
        const headerIcon = document.getElementById('header-icon');
        const originalTitle = headerTitle.textContent;
        const originalIconClass = headerIcon.className;
        const releaseCache = {};

        function showApps(os) {
            osSelection.style.display = 'none';
            const targetList = document.getElementById(`${os}-apps`);
            if (targetList) {
                targetList.style.display = 'block';
                const listHeader = targetList.querySelector('h2');
                headerTitle.textContent = listHeader.textContent;
                headerIcon.className = listHeader.querySelector('i').className;
                
                targetList.querySelectorAll('.app-content').forEach(container => {
                    const repo = container.dataset.repo;
                    if (repo && !releaseCache[repo]) {
                        fetchAndRenderReleases(repo, container.dataset.os);
                    }
                });
            }
        }

        function goBack() {
            appLists.forEach(list => list.style.display = 'none');
            osSelection.style.display = 'block';
            headerTitle.textContent = originalTitle;
            headerIcon.className = originalIconClass;
        }

        async function fetchAndRenderReleases(repo, os) {
            const container = document.querySelector(`.app-content[data-repo="${repo}"]`);
            container.innerHTML = '<div class="loading-spinner"></div>';
            
            try {
                const response = await fetch(`https://api.github.com/repos/${repo}/releases`);
                if (!response.ok) throw new Error(`خطا در ارتباط با گیت‌هاب (کد: ${response.status})`);
                
                const releases = await response.json();
                if (!releases || releases.length === 0) throw new Error('هیچ نسخه‌ای یافت نشد.');

                releaseCache[repo] = releases;
                renderAppContent(repo, os);
            } catch (error) {
                container.innerHTML = `<div class="error-message">${error.message}</div>`;
            }
        }
        
        function renderAppContent(repo, os) {
            const container = document.querySelector(`.app-content[data-repo="${repo}"]`);
            const releases = releaseCache[repo];
            let optionsHtml = '';
            releases.forEach((release, index) => {
                optionsHtml += `<option value="${index}">${release.tag_name}${index === 0 ? ' (جدیدترین)' : ''}</option>`;
            });

            container.innerHTML = `
                <div class="version-selector">
                    <label for="version-select-${repo.replace('/', '-')}">انتخاب نسخه:</label>
                    <select id="version-select-${repo.replace('/', '-')}" onchange="updateDownloads('${repo}', '${os}', this.value)">
                        ${optionsHtml}
                    </select>
                </div>
                <div class="download-links" id="downloads-for-${repo.replace('/', '-')}"></div>
            `;
            updateDownloads(repo, os, 0);
        }

        function getArchitecture(filename) {
            const lower_name = filename.toLowerCase();
            if (lower_name.includes('x64') || lower_name.includes('amd64') || lower_name.includes('x86_64')) return 'x64';
            if (lower_name.includes('arm64') || lower_name.includes('aarch64')) return 'ARM64';
            if (lower_name.includes('x86') || lower_name.includes('i386') || lower_name.includes('386')) return 'x86 (۳۲-بیت)';
            return '';
        }
        
        function updateDownloads(repo, os, releaseIndex) {
            const releases = releaseCache[repo];
            const selectedRelease = releases[releaseIndex];
            const downloadContainer = document.getElementById(`downloads-for-${repo.replace('/', '-')}`);
            
            if (!selectedRelease || !selectedRelease.assets || selectedRelease.assets.length === 0) {
                downloadContainer.innerHTML = '<div class="error-message">فایل دانلودی برای این نسخه یافت نشد.</div>';
                return;
            }

            const assets = selectedRelease.assets;
            
            if (os === 'linux') {
                renderLinuxDownloads(assets, downloadContainer);
            } else {
                renderStandardDownloads(assets, os, downloadContainer);
            }
        }

        function renderStandardDownloads(assets, os, container) {
            const patterns = {
                android: [/universal\.apk$/i],
                windows: [/\.zip$/i, /\.exe$/i],
                macos: [/\.dmg$/i, /\.zip$/i, /darwin/i]
            };
            const osPatterns = patterns[os] || [];
            let foundAssets = [];

            osPatterns.forEach(pattern => {
                assets.forEach(asset => {
                    if (pattern.test(asset.name) && !foundAssets.find(a => a.id === asset.id)) {
                        // For v2rayN, prefer 'v2rayN-Core.zip'
                        if (os === 'windows' && asset.name !== 'v2rayN-Core.zip') return;
                        foundAssets.push(asset);
                    }
                });
            });

            let linksHtml = '';
            if (foundAssets.length === 0) {
                linksHtml = `<div class="error-message">فایل مناسب برای ${os} در این نسخه یافت نشد.</div>`;
            } else {
                foundAssets.forEach(asset => {
                    const { name, browser_download_url } = asset;
                    let icon = 'fa-file-archive';
                    let label = 'دانلود فایل';
                    
                    if (/\.apk$/i.test(name)) { icon = 'fa-robot'; label = 'فایل نصب اندروید (Universal)'; }
                    if (/\.exe$/i.test(name)) { icon = 'fa-cogs'; label = 'فایل اجرایی (EXE)'; }
                    if (/\.zip$/i.test(name)) { icon = 'fa-file-archive'; label = 'دانلود فایل فشرده (ZIP)'; }
                    if (/\.dmg$/i.test(name)) { icon = 'fa-apple'; label = 'فایل نصب مک (DMG)'; }

                    const arch = (os !== 'android') ? getArchitecture(name) : '';
                    const archBadge = arch ? `<span class="arch-badge">${arch}</span>` : '';
                    linksHtml += `<a href="${browser_download_url}" target="_blank" rel="noopener noreferrer"><i class="fas ${icon}"></i><span class="link-text">${label}</span>${archBadge}</a>`;
                });
            }
            container.innerHTML = linksHtml;
        }

        function renderLinuxDownloads(assets, container) {
            const groups = {
                deb: { title: 'اوبونتو / دبیان', icon: 'fab fa-debian', assets: [] },
                rpm: { title: 'فدورا / سنت‌او‌اس', icon: 'fab fa-redhat', assets: [] },
                appImage: { title: 'نسخه عمومی', icon: 'fas fa-box-open', assets: [] },
                other: { title: 'سایر فایل‌ها', icon: 'fas fa-file-archive', assets: [] }
            };

            assets.forEach(asset => {
                const name = asset.name.toLowerCase();
                if (name.endsWith('.deb')) groups.deb.assets.push(asset);
                else if (name.endsWith('.rpm')) groups.rpm.assets.push(asset);
                else if (name.endsWith('.appimage')) groups.appImage.assets.push(asset);
                else if (name.includes('linux')) groups.other.assets.push(asset);
            });
            
            let html = '';
            for (const key in groups) {
                const group = groups[key];
                if (group.assets.length > 0) {
                    html += `<div class="download-group"><h4><i class="${group.icon}"></i> ${group.title}</h4>`;
                    group.assets.forEach(asset => {
                        const arch = getArchitecture(asset.name) || 'نامشخص';
                        html += `
                            <a href="${asset.browser_download_url}" target="_blank" rel="noopener noreferrer">
                                <i class="fas fa-download"></i>
                                <span class="link-text">دانلود برای هسته ${asset.name.split('.').pop()}</span>
                                <span class="arch-badge">${arch}</span>
                            </a>`;
                    });
                    html += '</div>';
                }
            }

            if (html === '') {
                html = '<div class="error-message">هیچ فایل مناسبی برای لینوکس در این نسخه یافت نشد.</div>';
            }
            container.innerHTML = html;
        }
    </script>
</body>
</html>