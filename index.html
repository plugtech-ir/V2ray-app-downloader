<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دانلود مستقیم کلاینت‌های V2Ray</title>
    <!-- فونت Vazirmatn -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap">
    <!-- فونت آیکون Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4f46e5;
            --primary-hover: #4338ca;
            --secondary-color: #f3f4f6;
            --text-color: #1f2937;
            --light-text: #6b7280;
            --success-color: #10b981;
            --border-color: #e5e7eb;
            --border-radius: 12px;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Vazirmatn', system-ui, -apple-system, sans-serif;
            background-color: #f8fafc;
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }

        .container { width: 100%; max-width: 700px; }

        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .card-header {
            padding: 1.5rem;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }

        .card-header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .card-body { padding: 2rem; }
        .card-footer {
            padding: 1rem 1.5rem;
            background-color: var(--secondary-color);
            text-align: center;
            font-size: 0.875rem;
            color: var(--light-text);
            border-top: 1px solid var(--border-color);
        }

        a { color: var(--primary-color); text-decoration: none; font-weight: 500; }
        a:hover { color: var(--primary-hover); }
        
        #os-selection .selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            text-align: center;
        }

        .os-card {
            background-color: white;
            padding: 2rem 1rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .os-card:hover { transform: translateY(-5px); box-shadow: var(--shadow); border-color: var(--primary-color); }
        .os-card i { font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem; }
        .os-card h3 { font-weight: 600; }
        
        .page-intro { text-align: center; color: var(--light-text); margin-bottom: 2rem; }
        .app-list { display: none; }

        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .back-btn {
            background: none; border: 1px solid #d1d5db; color: var(--light-text);
            padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer;
            transition: all 0.2s ease; display: flex; align-items: center; gap: 0.5rem;
            font-family: inherit;
        }
        .back-btn:hover { background-color: var(--secondary-color); color: var(--text-color); }

        .app-card {
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        .app-header {
            padding: 1rem 1.5rem;
            background-color: #f9fafb;
        }
        .app-header h3 { font-size: 1.1rem; display: flex; align-items: center; gap: 0.75rem; }
        .app-body { padding: 1.5rem; }
        .app-body p { font-size: 0.9rem; color: var(--light-text); margin-bottom: 1.5rem; }
        
        .version-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        .version-selector label { font-weight: 500; font-size: 0.9rem; }
        .version-selector select {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-family: inherit;
            background-color: white;
            flex-grow: 1;
        }

        .download-links a {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background-color: var(--secondary-color);
            border-radius: 8px;
            margin-bottom: 0.75rem;
            transition: all 0.2s ease;
            color: var(--text-color);
            font-weight: 500;
        }
        .download-links a:hover { background-color: #e5e7eb; color: var(--primary-color); }
        .download-links a i { width: 20px; text-align: center; }
        .download-links .latest-badge {
            background-color: var(--success-color); color: white;
            font-size: 0.7rem; padding: 0.1rem 0.5rem; border-radius: 9999px;
            margin-right: auto;
        }

        .loading-spinner {
            width: 30px; height: 30px;
            border: 3px solid rgba(79, 70, 229, 0.2);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
            margin: 2rem auto;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .error-message { text-align: center; color: #ef4444; padding: 1rem; }
    </style>
</head>

<body>
    <div class="container">
        <div class="card">
            <div class="card-header"><h1><i id="header-icon" class="fas fa-shield-alt"></i><span id="header-title">دانلود کلاینت‌های V2Ray</span></h1></div>
            <div class="card-body">

                <div id="os-selection">
                    <p class="page-intro">سیستم عامل دستگاه خود را انتخاب کنید تا بهترین کلاینت‌ها برای شما نمایش داده شود.</p>
                    <div class="selection-grid">
                        <div class="os-card" onclick="showApps('android')"><i class="fab fa-android"></i><h3>اندروید</h3></div>
                        <div class="os-card" onclick="showApps('ios')"><i class="fab fa-apple"></i><h3>آی‌او‌اس</h3></div>
                        <div class="os-card" onclick="showApps('windows')"><i class="fab fa-windows"></i><h3>ویندوز</h3></div>
                        <div class="os-card" onclick="showApps('macos')"><i class="fab fa-apple"></i><h3>مک</h3></div>
                        <div class="os-card" onclick="showApps('linux')"><i class="fab fa-linux"></i><h3>لینوکس</h3></div>
                    </div>
                </div>

                <!-- Android Apps -->
                <div id="android-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-android"></i> برنامه‌های اندروید</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                    <div class="app-card">
                        <div class="app-header"><h3><i class="fas fa-rocket"></i> v2rayNG</h3></div>
                        <div class="app-body">
                            <p>محبوب‌ترین کلاینت برای اندروید با رابط کاربری ساده. بهترین انتخاب برای اکثر کاربران.</p>
                            <div class="app-content" data-repo="2dust/v2rayNG" data-os="android"></div>
                        </div>
                    </div>
                </div>
                
                <!-- iOS has static links -->
                <div id="ios-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-apple"></i> برنامه‌های آی‌او‌اس</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                    <div class="app-card">
                        <div class="app-header"><h3><i class="fas fa-paper-plane"></i> Shadowrocket</h3></div>
                        <div class="app-body">
                            <p>قدرتمندترین و محبوب‌ترین اپلیکیشن پولی برای iOS با امکانات فوق‌العاده.</p>
                            <div class="download-links"><a href="https://apps.apple.com/us/app/shadowrocket/id932747118" target="_blank" rel="noopener noreferrer"><i class="fab fa-app-store-ios"></i> مشاهده در اپ استور</a></div>
                        </div>
                    </div>
                </div>
                
                <!-- Windows Apps -->
                <div id="windows-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-windows"></i> برنامه‌های ویندوز</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                    <div class="app-card">
                        <div class="app-header"><h3><i class="fas fa-leaf"></i> v2rayN</h3></div>
                        <div class="app-body">
                            <p>کلاینت استاندارد و محبوب ویندوز. استفاده آسان و پشتیبانی از تمام قابلیت‌ها.</p>
                            <div class="app-content" data-repo="2dust/v2rayN-Core" data-os="windows"></div>
                        </div>
                    </div>
                </div>
                
                 <!-- macOS Apps -->
                <div id="macos-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-apple"></i> برنامه‌های مک</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                     <div class="app-card">
                        <div class="app-header"><h3><i class="fas fa-draw-polygon"></i> Clash Verge</h3></div>
                        <div class="app-body">
                            <p>کلاینت مدرن مبتنی بر Clash با رابط کاربری زیبا و مدیریت آسان پروفایل‌ها.</p>
                            <div class="app-content" data-repo="zzzgydi/clash-verge" data-os="macos"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Linux Apps -->
                <div id="linux-apps" class="app-list">
                    <div class="list-header"><h2><i class="fab fa-linux"></i> برنامه‌های لینوکس</h2><button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-right"></i> بازگشت</button></div>
                    <div class="app-card">
                        <div class="app-header"><h3><i class="fas fa-network-wired"></i> v2rayA</h3></div>
                        <div class="app-body">
                            <p>کلاینت قدرتمند با رابط کاربری تحت وب که مدیریت آن را بسیار آسان می‌کند.</p>
                            <div class="app-content" data-repo="v2rayA/v2rayA" data-os="linux"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-footer"><div>نوشته شده توسط <a href="https://t.me/wolf_vpn02" target="_blank" rel="noopener noreferrer">WOLF VPN</a></div></div>
        </div>
    </div>

    <script>
        const osSelection = document.getElementById('os-selection');
        const appLists = document.querySelectorAll('.app-list');
        const headerTitle = document.getElementById('header-title');
        const headerIcon = document.getElementById('header-icon');
        const originalTitle = headerTitle.textContent;
        const originalIconClass = headerIcon.className;

        // Store fetched release data to avoid repeated API calls
        const releaseCache = {};

        function showApps(os) {
            osSelection.style.display = 'none';
            const targetList = document.getElementById(`${os}-apps`);
            if (targetList) {
                targetList.style.display = 'block';
                const listHeader = targetList.querySelector('h2');
                headerTitle.textContent = listHeader.textContent;
                headerIcon.className = listHeader.querySelector('i').className;
                
                // Fetch data for all apps in this OS section
                targetList.querySelectorAll('.app-content').forEach(container => {
                    const repo = container.dataset.repo;
                    if (repo && !releaseCache[repo]) { // Fetch only if not in cache
                        fetchAndRenderReleases(repo, container.dataset.os);
                    }
                });
            }
        }

        function goBack() {
            appLists.forEach(list => list.style.display = 'none');
            osSelection.style.display = 'block';
            headerTitle.textContent = originalTitle;
            headerIcon.className = originalIconClass;
        }

        async function fetchAndRenderReleases(repo, os) {
            const container = document.querySelector(`.app-content[data-repo="${repo}"]`);
            container.innerHTML = '<div class="loading-spinner"></div>';
            
            try {
                const response = await fetch(`https://api.github.com/repos/${repo}/releases`);
                if (!response.ok) throw new Error(`خطا در ارتباط با گیت‌هاب (کد: ${response.status})`);
                
                const releases = await response.json();
                if (!releases || releases.length === 0) throw new Error('هیچ نسخه‌ای برای این برنامه یافت نشد.');

                releaseCache[repo] = releases; // Cache the data
                renderAppContent(repo, os);
            } catch (error) {
                container.innerHTML = `<div class="error-message">${error.message}</div>`;
            }
        }
        
        function renderAppContent(repo, os) {
            const container = document.querySelector(`.app-content[data-repo="${repo}"]`);
            const releases = releaseCache[repo];
            const latestRelease = releases[0];

            let optionsHtml = '';
            releases.forEach((release, index) => {
                const isLatest = index === 0 ? ' (جدیدترین)' : '';
                optionsHtml += `<option value="${index}">${release.tag_name}${isLatest}</option>`;
            });

            container.innerHTML = `
                <div class="version-selector">
                    <label for="version-select-${repo.replace('/', '-')}">انتخاب نسخه:</label>
                    <select id="version-select-${repo.replace('/', '-')}" onchange="updateDownloads('${repo}', '${os}', this.value)">
                        ${optionsHtml}
                    </select>
                </div>
                <div class="download-links" id="downloads-for-${repo.replace('/', '-')}"></div>
            `;
            updateDownloads(repo, os, 0); // Show downloads for the latest version initially
        }
        
        function updateDownloads(repo, os, releaseIndex) {
            const releases = releaseCache[repo];
            const selectedRelease = releases[releaseIndex];
            const downloadContainer = document.getElementById(`downloads-for-${repo.replace('/', '-')}`);
            
            if (!selectedRelease || !selectedRelease.assets) {
                downloadContainer.innerHTML = '<div class="error-message">فایل دانلودی برای این نسخه یافت نشد.</div>';
                return;
            }

            let linksHtml = '';
            const assets = selectedRelease.assets;
            
            // Define file patterns for different OS
            const patterns = {
                android: [/\.apk$/i],
                windows: [/win64\.zip$/i, /win\.zip$/i, /\.exe$/i],
                macos: [/\.dmg$/i, /mac\.zip$/i, /darwin/i],
                linux: [/\.AppImage$/i, /\.deb$/i, /\.rpm$/i, /linux/i]
            };

            const osPatterns = patterns[os] || [];
            let foundAssets = [];

            osPatterns.forEach(pattern => {
                assets.forEach(asset => {
                    if (pattern.test(asset.name) && !foundAssets.includes(asset)) {
                        foundAssets.push(asset);
                    }
                });
            });

            // If no specific assets found, get generic ones
            if (foundAssets.length === 0) {
                 assets.forEach(asset => {
                    if (/\.(zip|tar\.gz)$/i.test(asset.name) && !foundAssets.includes(asset)){
                         foundAssets.push(asset);
                    }
                });
            }
            
            if (foundAssets.length === 0) {
                linksHtml = '<div class="error-message">فایل مناسب برای سیستم‌عامل شما در این نسخه یافت نشد.</div>';
            } else {
                foundAssets.forEach(asset => {
                    const { name, browser_download_url } = asset;
                    let icon = 'fa-file-archive';
                    let label = name;
                    
                    if (/\.apk$/i.test(name)) { icon = 'fa-robot'; label = 'فایل نصب اندروید (APK)'; }
                    if (/\.exe$/i.test(name)) { icon = 'fa-cogs'; label = 'فایل اجرایی ویندوز (EXE)'; }
                    if (/\.zip$/i.test(name)) { icon = 'fa-file-archive'; label = `فایل فشرده (${name.substring(0,20)}...)`; }
                    if (/\.dmg$/i.test(name)) { icon = 'fa-apple'; label = 'فایل نصب مک (DMG)'; }
                    if (/\.deb$/i.test(name)) { icon = 'fab fa-debian'; label = 'برای اوبونتو/دبیان (deb)'; }
                    if (/\.rpm$/i.test(name)) { icon = 'fab fa-redhat'; label = 'برای فدورا/سنت‌او‌اس (rpm)'; }
                    if (/\.AppImage$/i.test(name)) { icon = 'fas fa-box-open'; label = 'نسخه عمومی لینوکس (AppImage)'; }

                    const isLatestBadge = (releaseIndex == 0) ? '<span class="latest-badge">جدیدترین</span>' : '';
                    linksHtml += `<a href="${browser_download_url}" target="_blank" rel="noopener noreferrer"><i class="fas ${icon}"></i>${label} ${isLatestBadge}</a>`;
                });
            }

            downloadContainer.innerHTML = linksHtml;
        }
    </script>
</body>
</html>```
